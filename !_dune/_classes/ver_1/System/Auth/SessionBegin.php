<?php

class System_Auth_SessionBegin extends Dune_Include_Abstract_Code
{

    protected function code()
    {
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        

           $cooc = Dune_Cookie_ArraySingleton::getInstance(Dune_Parameters::$cookieNameSystem);
           $cooc['user_status']  = $this->user->getUserStatus();
           $cooc['user_array']   = $this->user->getUserArray();
           $cooc['user_name']    = $this->user->getUserName();
           $cooc['user_mail']    = $this->user->getUserMail();
           $cooc['user_login']    = $this->user->getUserMail();
           $cooc['user_id']      = $this->user->getUserId();
           $cooc['user_code']    = $this->user->getUserCode();
           $cooc['was_reg']      = 1;


           Dune_Session::$auth = true;
           $session = Dune_Session::getInstance(Dune_Session::ZONE_AUTH);
           $session->unlockZone('auth1');
           
           $session->user_code     = $cooc['user_code'];
           $session->user_mail     = $cooc['user_mail'];
           $session->user_login    = $cooc['user_login'];
           $session->user_name     = $cooc['user_name'];
           $session->user_status   = $cooc['user_status'];
           $session->user_array    = $cooc['user_array'];
           $session->user_id       = $cooc['user_id'];
                    
           $session->lockZone('auth1');

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
    }
    
}
    
    