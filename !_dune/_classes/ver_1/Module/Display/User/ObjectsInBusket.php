<?php

class Module_Display_User_ObjectsInBusket extends Dune_Include_Abstract_Code
{

    protected function code()
    {
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        


$list = new Special_Vtor_User_Object_Save($this->user->id);

$list->setActivity(1);
$count = $list->count();

$URL = Dune_Parsing_UrlSingleton::getInstance();
$page_curent = $URL->getCommandInt(3, 0);

$page_per = $this->perPage;
$view = Dune_Zend_View::getInstance();
$order_field = 'time_insert';
$order_direction = 'DESC';
 
if ($count)
{
    //$list->setOrderTimeInsert('DESC');
    $list->setOrder($order_field, $order_direction);
    $view->data = $list->getListCumulate($page_curent * $page_per, $page_per);
    $view->navigator_per_page = $this->perPage;
    $view->count = $count;
    $view->url_info = $this->url_info;
    $view->navigator_page = $page_curent;
    switch ($this->type)
    {
/*        case 1: // Квартиры
            $view->render('bit/catalogue/object/list/room');
        break;
        case 3: // Гаражи
            $view->render('bit/catalogue/object/list/garage');
        break;
        case 5: // Кладовки
            $view->render('bit/catalogue/object/list/pantry');
        break;
*/        
        default:
            echo $view->render('bit/user/activity/basket_list');
    }
}
else 
    echo '<h1>Нет объектов в корзине</h1>';


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
    }
    
}
    
    