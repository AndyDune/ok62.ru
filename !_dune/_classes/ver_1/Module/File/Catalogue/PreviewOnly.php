<?php

class Module_File_Catalogue_PreviewOnly extends Dune_Include_Abstract_Code
{

    protected function code()
    {
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        


        $planer = new Special_Vtor_Catalogue_Info_Plan($this->id, $this->time); // а есть ли планеровка (план)
        if ($planer->count())
        {
            $temp = $planer->getOneImage();
            $preview = $temp->getPreviewFileUrl();
        }
        else if ($this->pics)
        {
            $image = new Special_Vtor_Catalogue_Info_Image($this->id, $this->time);
            $temp = $image->getOneImage();
            $preview = $temp->getPreviewFileUrl();
        }
        else if (is_null($this->pics))
        {
            $image = new Special_Vtor_Catalogue_Info_Image($this->id, $this->time);
            if ($image->count())
            {
                $temp = $image->getOneImage();
                $preview = $temp->getPreviewFileUrl();
            }
            else 
                $preview = '';
            
        }
        else
        {
            $preview = '';
        }
        
        $this->setResult('preview', $preview);
           




/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
    }
    
}
    
    