<?php

class Module_OCatalogue_SectionTree extends Dune_Include_Abstract_Code
{

    protected function code()
    {
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        

    $array = array();
    $sec = new Special_Vtor_Organization_Sections_List();
    $sec->setParent(0);
    $main_list = $sec->getList();
    
    if ($main_list and count($main_list))
    {
        foreach ($main_list as $value)
        {
            $array_run = array();
            $array_run['level'] = 0;
            $array_run['data'] = $value;
            $array[] = $array_run;
            if ($value['count_children'])
            {
                    $sec->setParent($value['id']);
                    $list_2 = $sec->getList();
                    if ($list_2 and count($list_2))
                    {
                            foreach ($list_2 as $value2)
                            {
                                $array_run = array();
                                $array_run['level'] = 1;
                                $array_run['data'] = $value2;
                                $array[] = $array_run;
                            }
                    }

            }
        }
    }
    
    $this->setResult('array', $array);



/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////        
    }
    
}
    
    